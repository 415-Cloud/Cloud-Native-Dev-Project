@startuml User Service - ER Diagram

!define TABLE entity
!define PRIMARY_KEY <<PK>>
!define FOREIGN_KEY <<FK>>
!define NOT_NULL <<NN>>
!define UNIQUE <<U>>

title User Service - Entity Relationship Diagram

entity "Users" as users {
  * user_id : VARCHAR(255) <<PK>>
  --
  * email : VARCHAR(255) <<NN>> <<U>>
  * password_hash : VARCHAR(255) <<NN>>
  name : VARCHAR(255)
  profile_info : TEXT
  fitness_level : VARCHAR(50)
  goals : TEXT
  created_at : TIMESTAMP
  updated_at : TIMESTAMP
}

note right of users
  **User Service Database (user_db)**
  
  **Purpose**: Manages user profile information
  **Isolation**: Completely separate from other services
  **Data**: Profile and fitness-related user data
  
  **Key Features**:
  - User profile management
  - Fitness level tracking
  - Goal management
  - Profile information storage
  
  **Service Responsibilities**:
  - Profile creation (via auth-service)
  - Profile updates
  - Profile retrieval
  - User data management
  
  **Note**: password_hash is stored but not used
  for authentication (handled by auth-service)
end note

note bottom of users
  **Indexes for Performance**:
  - idx_users_email (fast email lookups)
  - idx_users_fitness_level (fitness level filtering)
  
  **Constraints**:
  - PRIMARY KEY: user_id
  - UNIQUE: email
  - NOT NULL: email, password_hash
  
  **Auto-updates**:
  - updated_at automatically updated on changes
end note

note left of users
  **Relationship with Auth Service**:
  - user_id matches auth-service credentials.user_id
  - No foreign key (separate databases)
  - Linked via API calls, not DB joins
  - Created during registration flow
end note

@enduml

